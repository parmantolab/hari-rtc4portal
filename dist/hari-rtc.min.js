function modalFactoryFactory(e,n,t,o,i,r,a){return function(c){function s(){return f.then(function(e){m||d(e,g)})}function d(e,i){if(m=angular.element(e),0===m.length)throw new Error("The template contains no elements; you need to wrap text nodes");if(v=t.$new(),p){i||(i={}),i.$scope=v;var r=o(p,i);h&&(v[h]=r),v.closeMe=l}else if(i)for(var a in i)v[a]=i[a];var c=n(m)(v);return c.modal({closable:!1,duration:100,blurring:!0}).modal("show")}function l(){return m?e.leave(m).then(function(){v.$destroy(),v=null,m.modal("hide"),m.remove(),m=null}):i.when()}function u(){return!!m}if(!(!c.template^!c.templateUrl))throw new Error("Expected modal to have exacly one of either `template` or `templateUrl`");var f,v,p=(c.template,c.controller||null),h=c.controllerAs,g=c.parameters,m=(angular.element(c.container||document.body),null);return f=c.template?i.when(c.template):r.get(c.templateUrl,{cache:a}).then(function(e){return e.data}),{activate:s,deactivate:l,active:u}}}!function(e){e.module("hariRtc.config",[]).value("hariRtc.config",{debug:!0}),e.module("hariRtc.directives",[]),e.module("hariRtc.services",[]),e.module("hariRtc",["btford.socket-io","app.config","hariRtc.config","hariRtc.directives","hariRtc.services"])}(angular),angular.module("hariRtc").run(["signaling","hariModal",function(e,n){e.on("messageReceived",function(e,t){switch(t.type){case"call":var o={parameters:{isCalling:!0,contactName:e}};n({templateUrl:"views/call.html",controller:"CallCtrl",parameters:o}).activate()}})}]),function(){var e,n,t="4.0.0";!function(){function t(n){var t=n.factory,o=function(t){var o=t;return"."===t.charAt(0)&&(o=n.id.slice(0,n.id.lastIndexOf(a))+a+t.slice(2)),e(o)};return n.exports={},delete n.factory,t(o,n.exports,n),n.exports}var o={},i=[],r={},a=".";e=function(e){if(!o[e])throw"module "+e+" not found";if(e in r){var n=i.slice(r[e]).join("->")+"->"+e;throw"Cycle in require graph: "+n}if(o[e].factory)try{return r[e]=i.length,i.push(e),t(o[e])}finally{delete r[e],i.pop()}return o[e].exports},n=function(e,n){if(o[e])throw"module "+e+" already defined";o[e]={id:e,factory:n}},n.remove=function(e){delete o[e]},n.moduleMap=o}(),"object"==typeof module&&"function"==typeof e&&(module.exports.require=e,module.exports.define=n),n("cordova",function(e,o,i){function r(e,n){var t=document.createEvent("Events");if(t.initEvent(e,!1,!1),n)for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o]);return t}if(window.cordova)throw new Error("cordova already defined");var a=e("cordova/channel"),c=e("cordova/platform"),s=document.addEventListener,d=document.removeEventListener,l=window.addEventListener,u=window.removeEventListener,f={},v={};document.addEventListener=function(e,n,t){var o=e.toLowerCase();"undefined"!=typeof f[o]?f[o].subscribe(n):s.call(document,e,n,t)},window.addEventListener=function(e,n,t){var o=e.toLowerCase();"undefined"!=typeof v[o]?v[o].subscribe(n):l.call(window,e,n,t)},document.removeEventListener=function(e,n,t){var o=e.toLowerCase();"undefined"!=typeof f[o]?f[o].unsubscribe(n):d.call(document,e,n,t)},window.removeEventListener=function(e,n,t){var o=e.toLowerCase();"undefined"!=typeof v[o]?v[o].unsubscribe(n):u.call(window,e,n,t)};var p={define:n,require:e,version:t,platformVersion:t,platformId:c.id,addWindowEventHandler:function(e){return v[e]=a.create(e)},addStickyDocumentEventHandler:function(e){return f[e]=a.createSticky(e)},addDocumentEventHandler:function(e){return f[e]=a.create(e)},removeWindowEventHandler:function(e){delete v[e]},removeDocumentEventHandler:function(e){delete f[e]},getOriginalHandlers:function(){return{document:{addEventListener:s,removeEventListener:d},window:{addEventListener:l,removeEventListener:u}}},fireDocumentEvent:function(e,n,t){var o=r(e,n);"undefined"!=typeof f[e]?t?f[e].fire(o):setTimeout(function(){"deviceready"==e&&document.dispatchEvent(o),f[e].fire(o)},0):document.dispatchEvent(o)},fireWindowEvent:function(e,n){var t=r(e,n);"undefined"!=typeof v[e]?setTimeout(function(){v[e].fire(t)},0):window.dispatchEvent(t)},callbackId:Math.floor(2e9*Math.random()),callbacks:{},callbackStatus:{NO_RESULT:0,OK:1,CLASS_NOT_FOUND_EXCEPTION:2,ILLEGAL_ACCESS_EXCEPTION:3,INSTANTIATION_EXCEPTION:4,MALFORMED_URL_EXCEPTION:5,IO_EXCEPTION:6,INVALID_ACTION:7,JSON_EXCEPTION:8,ERROR:9},callbackSuccess:function(e,n){p.callbackFromNative(e,!0,n.status,[n.message],n.keepCallback)},callbackError:function(e,n){p.callbackFromNative(e,!1,n.status,[n.message],n.keepCallback)},callbackFromNative:function(e,n,t,o,i){try{var r=p.callbacks[e];r&&(n&&t==p.callbackStatus.OK?r.success&&r.success.apply(null,o):n||r.fail&&r.fail.apply(null,o),i||delete p.callbacks[e])}catch(a){var c="Error in "+(n?"Success":"Error")+" callbackId: "+e+" : "+a;throw console&&console.log&&console.log(c),p.fireWindowEvent("cordovacallbackerror",{message:c}),a}},addConstructor:function(e){a.onCordovaReady.subscribe(function(){try{e()}catch(n){console.log("Failed to run constructor: "+n)}})}};i.exports=p}),n("cordova/argscheck",function(e,n,t){function o(e,n){return/.*?\((.*?)\)/.exec(e)[1].split(", ")[n]}function i(e,n,t,i){if(c.enableChecks){for(var r,d=null,l=0;l<e.length;++l){var u=e.charAt(l),f=u.toUpperCase(),v=t[l];if("*"!=u&&(r=a.typeName(v),(null!==v&&void 0!==v||u!=f)&&r!=s[f])){d="Expected "+s[f];break}}if(d)throw d+=", but got "+r+".",d='Wrong type for parameter "'+o(i||t.callee,l)+'" of '+n+": "+d,"undefined"==typeof jasmine&&console.error(d),TypeError(d)}}function r(e,n){return void 0===e?n:e}var a=e("cordova/utils"),c=t.exports,s={A:"Array",D:"Date",N:"Number",S:"String",F:"Function",O:"Object"};c.checkArgs=i,c.getValue=r,c.enableChecks=!0}),n("cordova/base64",function(e,n){function t(e){for(var n,t=e.byteLength,o="",i=a(),c=0;t-2>c;c+=3)n=(e[c]<<16)+(e[c+1]<<8)+e[c+2],o+=i[n>>12],o+=i[4095&n];return t-c==2?(n=(e[c]<<16)+(e[c+1]<<8),o+=i[n>>12],o+=r[(4095&n)>>6],o+="="):t-c==1&&(n=e[c]<<16,o+=i[n>>12],o+="=="),o}var o=n;o.fromArrayBuffer=function(e){var n=new Uint8Array(e);return t(n)},o.toArrayBuffer=function(e){for(var n="undefined"!=typeof atob?atob(e):new Buffer(e,"base64").toString("binary"),t=new ArrayBuffer(n.length),o=new Uint8Array(t),i=0,r=n.length;r>i;i++)o[i]=n.charCodeAt(i);return t};var i,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(){i=[];for(var e=0;64>e;e++)for(var n=0;64>n;n++)i[64*e+n]=r[e]+r[n];return a=function(){return i},i}}),n("cordova/builder",function(e,n){function t(e,n,t){for(var o in e)e.hasOwnProperty(o)&&n.apply(t,[e[o],o])}function o(e,t,o){n.replaceHookForTesting(e,t);var i=!1;try{e[t]=o}catch(r){i=!0}(i||e[t]!==o)&&c.defineGetter(e,t,function(){return o})}function i(e,n,t,i){i?c.defineGetter(e,n,function(){return console.log(i),delete e[n],o(e,n,t),t}):o(e,n,t)}function r(n,o,s,d){t(o,function(t,o){try{var l=t.path?e(t.path):{};s?("undefined"==typeof n[o]?i(n,o,l,t.deprecated):"undefined"!=typeof t.path&&(d?a(n[o],l):i(n,o,l,t.deprecated)),l=n[o]):"undefined"==typeof n[o]?i(n,o,l,t.deprecated):l=n[o],t.children&&r(l,t.children,s,d)}catch(u){c.alert("Exception building Cordova JS globals: "+u+' for key "'+o+'"')}})}function a(e,n){for(var t in n)n.hasOwnProperty(t)&&(e.prototype&&e.prototype.constructor===e?o(e.prototype,t,n[t]):"object"==typeof n[t]&&"object"==typeof e[t]?a(e[t],n[t]):o(e,t,n[t]))}var c=e("cordova/utils");n.buildIntoButDoNotClobber=function(e,n){r(n,e,!1,!1)},n.buildIntoAndClobber=function(e,n){r(n,e,!0,!1)},n.buildIntoAndMerge=function(e,n){r(n,e,!0,!0)},n.recursiveMerge=a,n.assignOrWrapInDeprecateGetter=i,n.replaceHookForTesting=function(){}}),n("cordova/channel",function(e,n,t){function o(e){if("function"!=typeof e)throw"Function required as first argument!"}var i=e("cordova/utils"),r=1,a=function(e,n){this.type=e,this.handlers={},this.state=n?1:0,this.fireArgs=null,this.numHandlers=0,this.onHasSubscribersChange=null},c={join:function(e,n){for(var t=n.length,o=t,i=function(){--o||e()},r=0;t>r;r++){if(0===n[r].state)throw Error("Can only use join with sticky channels.");n[r].subscribe(i)}t||e()},create:function(e){return c[e]=new a(e,!1)},createSticky:function(e){return c[e]=new a(e,!0)},deviceReadyChannelsArray:[],deviceReadyChannelsMap:{},waitForInitialization:function(e){if(e){var n=c[e]||this.createSticky(e);this.deviceReadyChannelsMap[e]=n,this.deviceReadyChannelsArray.push(n)}},initializationComplete:function(e){var n=this.deviceReadyChannelsMap[e];n&&n.fire()}};a.prototype.subscribe=function(e,n){if(o(e),2==this.state)return e.apply(n||this,this.fireArgs),void 0;var t=e,a=e.observer_guid;"object"==typeof n&&(t=i.close(n,e)),a||(a=""+r++),t.observer_guid=a,e.observer_guid=a,this.handlers[a]||(this.handlers[a]=t,this.numHandlers++,1==this.numHandlers&&this.onHasSubscribersChange&&this.onHasSubscribersChange())},a.prototype.unsubscribe=function(e){o(e);var n=e.observer_guid,t=this.handlers[n];t&&(delete this.handlers[n],this.numHandlers--,0===this.numHandlers&&this.onHasSubscribersChange&&this.onHasSubscribersChange())},a.prototype.fire=function(){var e=Array.prototype.slice.call(arguments);if(1==this.state&&(this.state=2,this.fireArgs=e),this.numHandlers){var n=[];for(var t in this.handlers)n.push(this.handlers[t]);for(var o=0;o<n.length;++o)n[o].apply(this,e);2==this.state&&this.numHandlers&&(this.numHandlers=0,this.handlers={},this.onHasSubscribersChange&&this.onHasSubscribersChange())}},c.createSticky("onDOMContentLoaded"),c.createSticky("onNativeReady"),c.createSticky("onCordovaReady"),c.createSticky("onPluginsReady"),c.createSticky("onDeviceReady"),c.create("onResume"),c.create("onPause"),c.waitForInitialization("onCordovaReady"),c.waitForInitialization("onDOMContentLoaded"),t.exports=c}),n("cordova/confighelper",function(e,n){function t(e){function n(e){var n=new DOMParser,t=n.parseFromString(e.responseText,"application/xml"),o=t.getElementsByTagName("preference");return Array.prototype.slice.call(o)}this.xhr=e,this.preferences=n(this.xhr)}function o(e,n){function o(e){console.error(e),n&&n(e)}var r;"undefined"!=typeof i&&e(i);var a=function(){4==r.readyState&&(200==r.status||304==r.status||0===r.status?(i=new t(r),e(i)):o("[Browser][cordova.js][xhrStatusChangeHandler] Could not XHR config.xml: "+r.statusText))};"ActiveXObject"in window?(r=new window.ActiveXObject("MSXML2.XMLHTTP"),r.onreadystatechange=a):(r=new XMLHttpRequest,r.addEventListener("load",a));try{r.open("get","config.xml",!0),r.send()}catch(c){o("[Browser][cordova.js][readConfig] Could not XHR config.xml: "+JSON.stringify(c))}}var i;t.prototype.getPreferenceValue=function(e){var n=this.preferences&&this.preferences.filter(function(n){return n.attributes.name&&n.attributes.name.value===e});return n&&n[0]&&n[0].attributes&&n[0].attributes.value?n[0].attributes.value.value:void 0},n.readConfig=o}),n("cordova/exec",function(e,n,t){var o=e("cordova"),i=e("cordova/exec/proxy");t.exports=function(e,n,t,r,a){var c=i.get(t,r);if(c){var s=t+o.callbackId++;("function"==typeof e||"function"==typeof n)&&(o.callbacks[s]={success:e,fail:n});try{c(e,n,a)}catch(d){var l="Exception calling :: "+t+" :: "+r+" ::exception="+d;console.log(l)}}else n&&n("Missing Command Error")}}),n("cordova/exec/proxy",function(e,n,t){var o={};t.exports={add:function(e,n){return console.log("adding proxy for "+e),o[e]=n,n},remove:function(e){var n=o[e];return delete o[e],o[e]=null,n},get:function(e,n){return o[e]?o[e][n]:null}}}),n("cordova/init",function(e){function n(e){for(var n=0;n<e.length;++n)2!=e[n].state&&console.log("Channel not fired: "+e[n].type)}function t(e){var n=function(){};n.prototype=e;var t=new n;if(n.bind)for(var o in e)"function"==typeof e[o]?t[o]=e[o].bind(e):!function(n){s.defineGetterSetter(t,o,function(){return e[n]})}(o);return t}var o=e("cordova/channel"),i=e("cordova"),r=e("cordova/modulemapper"),a=e("cordova/platform"),c=e("cordova/pluginloader"),s=e("cordova/utils"),d=[o.onNativeReady,o.onPluginsReady];window.setTimeout(function(){2!=o.onDeviceReady.state&&(console.log("deviceready has not fired after 5 seconds."),n(d),n(o.deviceReadyChannelsArray))},5e3),window.navigator&&(window.navigator=t(window.navigator)),window.console||(window.console={log:function(){}}),window.console.warn||(window.console.warn=function(e){this.log("warn: "+e)}),o.onPause=i.addDocumentEventHandler("pause"),o.onResume=i.addDocumentEventHandler("resume"),o.onActivated=i.addDocumentEventHandler("activated"),o.onDeviceReady=i.addStickyDocumentEventHandler("deviceready"),"complete"==document.readyState||"interactive"==document.readyState?o.onDOMContentLoaded.fire():document.addEventListener("DOMContentLoaded",function(){o.onDOMContentLoaded.fire()},!1),window._nativeReady&&o.onNativeReady.fire(),r.clobbers("cordova","cordova"),r.clobbers("cordova/exec","cordova.exec"),r.clobbers("cordova/exec","Cordova.exec"),a.bootstrap&&a.bootstrap(),setTimeout(function(){c.load(function(){o.onPluginsReady.fire()})},0),o.join(function(){r.mapModules(window),a.initialize&&a.initialize(),o.onCordovaReady.fire(),o.join(function(){e("cordova").fireDocumentEvent("deviceready")},o.deviceReadyChannelsArray)},d)}),n("cordova/init_b",function(e){function n(e){for(var n=0;n<e.length;++n)2!=e[n].state&&console.log("Channel not fired: "+e[n].type)}function t(e){var n=function(){};n.prototype=e;var t=new n;if(n.bind)for(var o in e)"function"==typeof e[o]?t[o]=e[o].bind(e):!function(n){c.defineGetterSetter(t,o,function(){return e[n]})}(o);return t}var o=e("cordova/channel"),i=e("cordova"),r=e("cordova/modulemapper"),a=e("cordova/platform"),c=e("cordova/utils"),s=[o.onDOMContentLoaded,o.onNativeReady];i.exec=e("cordova/exec"),window.setTimeout(function(){2!=o.onDeviceReady.state&&(console.log("deviceready has not fired after 5 seconds."),n(s),n(o.deviceReadyChannelsArray))},5e3),window.navigator&&(window.navigator=t(window.navigator)),window.console||(window.console={log:function(){}}),window.console.warn||(window.console.warn=function(e){this.log("warn: "+e)}),o.onPause=i.addDocumentEventHandler("pause"),o.onResume=i.addDocumentEventHandler("resume"),o.onActivated=i.addDocumentEventHandler("activated"),o.onDeviceReady=i.addStickyDocumentEventHandler("deviceready"),"complete"==document.readyState||"interactive"==document.readyState?o.onDOMContentLoaded.fire():document.addEventListener("DOMContentLoaded",function(){o.onDOMContentLoaded.fire()},!1),window._nativeReady&&o.onNativeReady.fire(),a.bootstrap&&a.bootstrap(),o.join(function(){r.mapModules(window),a.initialize&&a.initialize(),o.onCordovaReady.fire(),o.join(function(){e("cordova").fireDocumentEvent("deviceready")},o.deviceReadyChannelsArray)},s)}),n("cordova/modulemapper",function(e,t){function o(e,n,t,o){if(!(n in s))throw new Error("Module "+n+" does not exist.");r.push(e,n,t),o&&(a[t]=o)}function i(e,n){if(!e)return n;for(var t,o=e.split("."),i=n,r=0;t=o[r];++r)i=i[t]=i[t]||{};return i}var r,a,c=e("cordova/builder"),s=n.moduleMap;t.reset=function(){r=[],a={}},t.clobbers=function(e,n,t){o("c",e,n,t)},t.merges=function(e,n,t){o("m",e,n,t)},t.defaults=function(e,n,t){o("d",e,n,t)},t.runs=function(e){o("r",e,null)},t.mapModules=function(n){var t={};n.CDV_origSymbols=t;for(var o=0,s=r.length;s>o;o+=3){var d=r[o],l=r[o+1],u=e(l);if("r"!=d){var f=r[o+2],v=f.lastIndexOf("."),p=f.substr(0,v),h=f.substr(v+1),g=f in a?"Access made to deprecated symbol: "+f+". "+g:null,m=i(p,n),y=m[h];"m"==d&&y?c.recursiveMerge(y,u):("d"==d&&!y||"d"!=d)&&(f in t||(t[f]=y),c.assignOrWrapInDeprecateGetter(m,h,u,g))}}},t.getOriginalSymbol=function(e,n){var t=e.CDV_origSymbols;if(t&&n in t)return t[n];for(var o=n.split("."),i=e,r=0;r<o.length;++r)i=i&&i[o[r]];return i},t.reset()}),n("cordova/modulemapper_b",function(e,n){function t(e,n,t,o){a.push(e,n,t),o&&(i[t]=o)}function o(e,n){if(!e)return n;for(var t,o=e.split("."),i=n,r=0;t=o[r];++r)i=i[t]=i[t]||{};return i}var i,r=e("cordova/builder"),a=[];n.reset=function(){a=[],i={}},n.clobbers=function(e,n,o){t("c",e,n,o)},n.merges=function(e,n,o){t("m",e,n,o)},n.defaults=function(e,n,o){t("d",e,n,o)},n.runs=function(e){t("r",e,null)},n.mapModules=function(n){var t={};n.CDV_origSymbols=t;for(var c=0,s=a.length;s>c;c+=3){var d=a[c],l=a[c+1],u=e(l);if("r"!=d){var f=a[c+2],v=f.lastIndexOf("."),p=f.substr(0,v),h=f.substr(v+1),g=f in i?"Access made to deprecated symbol: "+f+". "+g:null,m=o(p,n),y=m[h];"m"==d&&y?r.recursiveMerge(y,u):("d"==d&&!y||"d"!=d)&&(f in t||(t[f]=y),r.assignOrWrapInDeprecateGetter(m,h,u,g))}}},n.getOriginalSymbol=function(e,n){var t=e.CDV_origSymbols;if(t&&n in t)return t[n];for(var o=n.split("."),i=e,r=0;r<o.length;++r)i=i&&i[o[r]];return i},n.reset()}),n("cordova/platform",function(e,n,t){t.exports={id:"browser",cordovaVersion:"3.4.0",bootstrap:function(){var n=e("cordova/modulemapper"),t=e("cordova/channel");n.clobbers("cordova/exec/proxy","cordova.commandProxy"),t.onNativeReady.fire(),document.addEventListener("webkitvisibilitychange",function(){document.webkitHidden?t.onPause.fire():t.onResume.fire()},!1)}}}),n("cordova/pluginloader",function(e,t){function o(e,o,i,r){r=r||i,e in n.moduleMap?i():t.injectScript(o,function(){e in n.moduleMap?i():r()},r)}function i(e,n){for(var t,o=0;t=e[o];o++){if(t.clobbers&&t.clobbers.length)for(var i=0;i<t.clobbers.length;i++)c.clobbers(t.id,t.clobbers[i]);if(t.merges&&t.merges.length)for(var r=0;r<t.merges.length;r++)c.merges(t.id,t.merges[r]);t.runs&&c.runs(t.id)}n()}function r(e,n,t){function r(){--a||i(n,t)}var a=n.length;if(!a)return t(),void 0;for(var c=0;c<n.length;c++)o(n[c].id,e+n[c].file,r)}function a(){for(var e=null,n=document.getElementsByTagName("script"),t="/cordova.js",o=n.length-1;o>-1;o--){var i=n[o].src.replace(/\?.*$/,"");if(i.indexOf(t)==i.length-t.length){e=i.substring(0,i.length-t.length)+"/";break}}return e}{var c=e("cordova/modulemapper");e("cordova/urlutil")}t.injectScript=function(e,n,t){var o=document.createElement("script");o.onload=n,o.onerror=t,o.src=e,document.head.appendChild(o)},t.load=function(n){var t=a();null===t&&(console.log("Could not find cordova.js script tag. Plugin loading may fail."),t=""),o("cordova/plugin_list",t+"cordova_plugins.js",function(){var o=e("cordova/plugin_list");r(t,o,n)},n)}}),n("cordova/urlutil",function(e,n){n.makeAbsolute=function(e){var n=document.createElement("a");return n.href=e,n.href}}),n("cordova/utils",function(e,n){function t(e){for(var n="",t=0;e>t;t++){var o=parseInt(256*Math.random(),10).toString(16);1==o.length&&(o="0"+o),n+=o}return n}var o=n;o.defineGetterSetter=function(e,n,t,o){if(Object.defineProperty){var i={get:t,configurable:!0};o&&(i.set=o),Object.defineProperty(e,n,i)}else e.__defineGetter__(n,t),o&&e.__defineSetter__(n,o)},o.defineGetter=o.defineGetterSetter,o.arrayIndexOf=function(e,n){if(e.indexOf)return e.indexOf(n);for(var t=e.length,o=0;t>o;++o)if(e[o]==n)return o;return-1},o.arrayRemove=function(e,n){var t=o.arrayIndexOf(e,n);return-1!=t&&e.splice(t,1),-1!=t},o.typeName=function(e){return Object.prototype.toString.call(e).slice(8,-1)},o.isArray=Array.isArray||function(e){return"Array"==o.typeName(e)},o.isDate=function(e){return e instanceof Date},o.clone=function(e){if(!e||"function"==typeof e||o.isDate(e)||"object"!=typeof e)return e;var n,t;if(o.isArray(e)){for(n=[],t=0;t<e.length;++t)n.push(o.clone(e[t]));return n}n={};for(t in e)t in n&&n[t]==e[t]||(n[t]=o.clone(e[t]));return n},o.close=function(e,n,t){return function(){var o=t||arguments;return n.apply(e,o)}},o.createUUID=function(){return t(4)+"-"+t(2)+"-"+t(2)+"-"+t(2)+"-"+t(6)},o.extend=function(){var e=function(){};return function(n,t){e.prototype=t.prototype,n.prototype=new e,n.__super__=t.prototype,n.prototype.constructor=n}}(),o.alert=function(e){window.alert?window.alert(e):console&&console.log&&console.log(e)}}),window.cordova=e("cordova"),e("cordova/init")}(),cordova.define("cordova/plugin_list",function(e,n,t){t.exports=[{file:"phonertc.js",id:"com.dooble.phonertc.PhoneRTC",clobbers:["cordova.plugins.phonertc"]},{file:"PhoneRTCProxy.js",id:"com.dooble.phonertc.PhoneRTCProxy",runs:!0}],t.exports.metadata={"com.dooble.phonertc":"2.1.0","cordova-plugin-compat":"1.1.0"}}),cordova.define("com.dooble.phonertc.PhoneRTC",function(e,n){function t(){for(var e=[],n="0123456789abcdef",t=0;36>t;t++)e[t]=n.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=n.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var o=e.join("");return o}function o(e){function n(e){if(i.events[e]){var n=Array.prototype.slice.call(arguments,1);i.events[e].forEach(function(e){e.apply(i,n)})}}function o(e){"__answered"===e.type?n("answer"):"__disconnected"===e.type?n("disconnect"):n("sendMessage",e)}if("object"!=typeof e)throw{name:"PhoneRTC Error",message:"The first argument must be an object."};if("undefined"==typeof e.isInitiator||"undefined"==typeof e.turn||"undefined"==typeof e.streams)throw{name:"PhoneRTC Error",message:"isInitiator, turn and streams are required parameters."};var i=this;i.events={},i.config=e,i.sessionKey=t(),Object.keys(e).forEach(function(e){Object.defineProperty(i,e,{get:function(){return i.config[e]},set:function(n){i.config[e]=n}})}),c(o,null,"PhoneRTCPlugin","createSessionObject",[i.sessionKey,e])}function i(e){var n=e.getBoundingClientRect();return"android"===cordova.platformId?{position:[n.left+window.scrollX,n.top+window.scrollY],size:[n.width,n.height]}:{position:[n.left,n.top],size:[n.width,n.height]}}function r(e){a=e;var n=e.container;n&&(e.containerParams=i(n),delete e.container),e.devicePixelRatio=window.devicePixelRatio||2,c(null,null,"PhoneRTCPlugin","setVideoView",[e]),n&&(e.container=n)}var a,c=e("cordova/exec");o.prototype.on=function(e,n){if("function"!=typeof n)throw{name:"PhoneRTC Error",message:"The second argument must be a function."};if(this.events[e]){for(var t=0,o=this.events[e].length;o>t;t++)if(this.events[e][t]===n)throw{name:"PhoneRTC Error",message:"This callback function was already added."}}else this.events[e]=[];this.events[e].push(n)},o.prototype.off=function(e,n){if("function"!=typeof n)throw{name:"PhoneRTC Error",message:"The second argument must be a function."};if(this.events[e]){for(var t=[],o=0,i=this.events[e].length;i>o;o++)this.events[e][o]===n&&t.push(o);t.forEach(function(e){this.events.splice(e,1)})}},o.prototype.call=function(e,n){c(e,n,"PhoneRTCPlugin","call",[{sessionKey:this.sessionKey}])},o.prototype.receiveMessage=function(e){c(null,null,"PhoneRTCPlugin","receiveMessage",[{sessionKey:this.sessionKey,message:JSON.stringify(e)}])},o.prototype.renegotiate=function(){c(null,null,"PhoneRTCPlugin","renegotiate",[{sessionKey:this.sessionKey,config:this.config}])},o.prototype.close=function(){c(null,null,"PhoneRTCPlugin","disconnect",[{sessionKey:this.sessionKey}])},n.Session=o,document.addEventListener("touchmove",function(){a&&r(a)}),n.setVideoView=r,n.hideVideoView=function(){c(null,null,"PhoneRTCPlugin","hideVideoView",[])},n.showVideoView=function(){c(null,null,"PhoneRTCPlugin","showVideoView",[])},n.stopLocalStream=function(){c(null,null,"PhoneRTCPlugin","stopLocalStream",[])},n.checkPermissions=function(e,n){c(e,n,"PhoneRTCPlugin","checkPermissions",[])}}),cordova.define("com.dooble.phonertc.PhoneRTCProxy",function(e,n,t){function o(e,n,t){var o=this;o.sessionKey=e,o.config=n,o.sendMessage=t,o.onIceCandidate=function(e){e.candidate&&o.sendMessage({type:"candidate",label:e.candidate.sdpMLineIndex,id:e.candidate.sdpMid,candidate:e.candidate.candidate})},o.onRemoteStreamAdded=function(e){o.videoView=i(e.stream),o.sendMessage({type:"__answered"})},o.setRemote=function(e){e.sdp=o.addCodecParam(e.sdp,"opus/48000","stereo=1"),this.peerConnection.setRemoteDescription(new f(e),function(){console.log("setRemote success")},function(e){console.log(e)})},o.addCodecParam=function(e,n,t){var i,r=e.split("\r\n"),a=o.findLine(r,"a=rtpmap",n);a&&(i=o.getCodecPayloadType(r[a]));var c=o.findLine(r,"a=fmtp:"+i.toString());return null===c?e:(r[c]=r[c].concat("; ",t),e=r.join("\r\n"))},o.findLine=function(e,n,t){return o.findLineInRange(e,0,-1,n,t)},o.findLineInRange=function(e,n,t,o,i){for(var r=-1!==t?t:e.length,a=n;r>a;++a)if(0===e[a].indexOf(o)&&(!i||-1!==e[a].toLowerCase().indexOf(i.toLowerCase())))return a;return null},o.getCodecPayloadType=function(e){var n=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),t=e.match(n);return t&&2===t.length?t[1]:null},o.setDefaultCodec=function(e,n){for(var t=e.split(" "),o=[],i=0,r=0;r<t.length;r++)3===i&&(o[i++]=n),t[r]!==n&&(o[i++]=t[r]);return o.join(" ")}}function i(e){var n=document.createElement("video");return n.autoplay=!0,n.addEventListener("loadedmetadata",d),n.style.position="absolute",n.style.zIndex=998,n.src=URL.createObjectURL(e),n.load(),b.push(n),document.body.appendChild(n),c(),n}function r(e){console.log(b),e.parentNode.removeChild(e),b.splice(e,1),console.log(b),c()}function a(e,n,t){return Math.round((t-n*e)/2)}function c(){var e=b.length;if(0!==e)for(var n=9>e?2:3,t=2===e?2:Math.ceil(e/n),o=m.containerParams.size[0]/t,i=Math.ceil(e/t),r=a(i,o,m.containerParams.size[1])+m.containerParams.position[1],c=0,s=0;n>s&&e>c;s++){for(var d=m.containerParams.position[0]+a(n-1>s||e%n===0?t:e-(Math.min(e,c+t)-1),o,m.containerParams.size[0]),l=0;t>l&&e>c;l++){var u=b[c++];u.style.width=o+"px",u.style.height=o+"px",u.style.left=d+"px",u.style.top=r+"px",d+=o}r+=o}}function s(){y.style.width=m.local.size[0]+"px",y.style.height=m.local.size[1]+"px",y.style.display="",y.style.left=m.containerParams.position[0]+m.local.position[0]+"px",y.style.top=m.containerParams.position[1]+m.local.position[1]+"px"}function d(){function e(){var r=o.videoWidth>o.videoHeight,a=o.videoWidth/o.videoHeight,c=r?"scaleY":"scaleX",s=r?a/i:i/a;if(n!==c||t!==s){var d=c+"("+s+")";o.style.webkitTransform=d,o.style.MozTransform=d,o.style.msTransform=d,o.style.OTransform=d,o.style.transform=d,n=c,t=s}setTimeout(e,100)}var n,t,o=this,i=o.offsetWidth/o.offsetHeight;e()}function l(e){delete w[e],0===Object.keys(w).length&&(y&&(document.body.removeChild(y),y=null),g.forEach(function(e){e.getTracks().forEach(function(e){e.stop()})}),g=[],p=null,h=null)}var u=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,f=(window.mozRTCIceCandidate||window.RTCIceCandidate,window.mozRTCSessionDescription||window.RTCSessionDescription),v=window.webkitMediaStream||window.mozMediaStream||window.MediaStream;navigator.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia;var p,h,g=[];o.prototype.createOrUpdateStream=function(){this.localStream&&this.peerConnection.removeStream(this.localStream),this.localStream=new v,this.config.streams.audio&&this.localStream.addTrack(h),this.config.streams.video&&this.localStream.addTrack(p),this.peerConnection.addStream(this.localStream)},o.prototype.sendOffer=function(){var e=this;e.peerConnection.createOffer(function(n){e.peerConnection.setLocalDescription(n,function(){console.log("Set session description success.")},function(e){console.log(e)}),e.sendMessage(n)},function(e){console.log(e)},{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!!m}})},o.prototype.sendAnswer=function(){var e=this;e.peerConnection.createAnswer(function(n){e.peerConnection.setLocalDescription(n,function(){console.log("Set session description success.")},function(e){console.log(e)}),e.sendMessage(n)},function(e){console.log(e)},{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!!m}})},o.prototype.call=function(){function e(){n.peerConnection=new u({iceServers:[{url:"stun:stun.l.google.com:19302"},{url:n.config.turn.host,username:n.config.turn.username,password:n.config.turn.password}]},{optional:[{DtlsSrtpKeyAgreement:!0}]}),n.peerConnection.onicecandidate=n.onIceCandidate,n.peerConnection.onaddstream=n.onRemoteStreamAdded,n.createOrUpdateStream.call(n),n.config.isInitiator&&n.sendOffer.call(n)}var n=this,t={video:n.config.streams.video&&!p,audio:n.config.streams.audio&&!h};t.audio||t.video?navigator.getUserMedia(t,function(n){g.push(n),t.audio&&(console.log("missing audio stream; retrieving"),h=n.getAudioTracks()[0]),t.video&&(console.log("missing video stream; retrieving"),p=n.getVideoTracks()[0]),e()},function(e){console.log(e)}):e()},o.prototype.receiveMessage=function(e){var n=this;if("offer"===e.type)n.setRemote(e),n.sendAnswer.call(n);else if("answer"===e.type)n.setRemote(e);else if("candidate"===e.type){var t=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});n.peerConnection.addIceCandidate(t,function(){console.log("Remote candidate added successfully.")},function(e){console.log(e)})}else"bye"===e.type&&this.disconnect(!1)},o.prototype.renegotiate=function(){this.config.isInitiator?this.sendOffer():this.sendAnswer()},o.prototype.disconnect=function(e){console.log(this.videoView),this.videoView&&r(this.videoView),e&&this.sendMessage({type:"bye"}),this.peerConnection.close(),this.peerConnection=null,this.sendMessage({type:"__disconnected"}),l(this.sessionKey)};var m,y,w={},b=[];t.exports={createSessionObject:function(e,n,t){var i=t[0],r=new o(i,t[1],e);r.sendMessage({type:"__set_session_key",sessionKey:i}),w[i]=r},call:function(e,n,t){w[t[0].sessionKey].call()},receiveMessage:function(e,n,t){w[t[0].sessionKey].receiveMessage(JSON.parse(t[0].message))},renegotiate:function(){console.log("Renegotiation is currently only supported in iOS and Android.")},disconnect:function(e,n,t){var o=w[t[0].sessionKey];o&&o.disconnect(!0)},setVideoView:function(e,n,t){if(m=t[0],0!==m.containerParams.size[0]&&0!==m.containerParams.size[1]&&m.local)if(y)s(),c();else{if(y=document.createElement("video"),y.autoplay=!0,y.muted=!0,y.style.position="absolute",y.style.zIndex=1001,y.addEventListener("loadedmetadata",d),s(),p){var o=new v;o.addTrack(p),y.src=URL.createObjectURL(o),y.load()}else navigator.getUserMedia({audio:!0,video:!0},function(e){g.push(e),h=e.getAudioTracks()[0],p=e.getVideoTracks()[0],y.src=URL.createObjectURL(e),y.load()},function(e){console.log(e)});document.body.appendChild(y)}},hideVideoView:function(){y.style.display="none",b.forEach(function(e){e.style.display="none"})},showVideoView:function(){y.style.display="",b.forEach(function(e){e.style.display=""})},stopLocalStream:function(){y.style.display="none",g.forEach(function(e){e.getTracks().forEach(function(e){e.stop()})}),g=[],p=null,h=null}},e("cordova/exec/proxy").add("PhoneRTCPlugin",t.exports)}),angular.module("hariRtc").run(["$templateCache",function(e){e.put("views/call.html",'<div class="ui modal" on-scroll="updateVideoPosition()" on-scroll-complete="updateVideoPosition()">\n    <div class="calling-container" ng-if="isCalling && !callInProgress">\n      <p>Calling to <span class="balanced">{{ contactName }}</span>...</p>\n\n      <div class="ui button red" ng-click="ignore()">\n        Nevermind\n      </div>\n    </div>\n\n    <div class="calling-container" ng-if="!isCalling && !callInProgress">\n      <p><span class="balanced">{{ contactName }}</span> is calling you</p>\n\n      <div class="ui button primary" ng-click="answer()">\n        Answer\n      </div>\n\n      <div class="ui button red" ng-click="ignore()">\n        Ignore\n      </div>\n    </div>\n\n    <div class="calling-container" ng-if="callInProgress">\n      <p>\n        Call in progress...\n      </p>\n\n      <div class="ui button red" ng-click="end()">\n        End\n      </div>\n    </div>\n\n    <video-view></video-view>\n\n  </div>'),e.put("views/select_contact.html",'<ion-modal-view>\n  <ion-header-bar class="bar-positive">\n    <h1 class="title">Add Contact to Call</h1>\n      <button class="button button-clear" ng-click="closeSelectContactModal()">\n        Close\n      </button>\n  </ion-header-bar>\n  <ion-content>\n    <ul class="list">\n      <li class="item item-button-right"\n          ng-repeat="contact in allContacts | filter:hideCurrentUsers()">\n        <i class="icon ion-record" style="color: green"></i>\n        {{ contact }}\n        <button class="button button-positive" \n                ng-click="addContact(contact)">\n          <i class="icon ion-ios7-telephone"></i>\n        </button>\n      </li>\n    </ul>\n  </ion-content>\n</ion-modal-view>')}]),angular.module("hariRtc").controller("CallCtrl",["$scope","$rootScope","$timeout","signaling","ContactsService","parameters",function(e,n,t,o,i,r){function a(n,t){console.log((new Date).toString()+": calling to "+t+", isInitiator: "+n),clearInterval(window.ringingIntervalId);
var i={isInitiator:n,turn:{host:"stun:stun.l.google.com:19302",username:"test",password:"test"},streams:{audio:!0,video:!0}},r=new cordova.plugins.phonertc.Session(i);r.on("sendMessage",function(e){o.emit("sendMessage",t,{type:"phonertc_handshake",data:JSON.stringify(e)})}),r.on("answer",function(){console.log("Answered!")}),r.on("disconnect",function(){e.contacts[t]&&delete e.contacts[t],0===Object.keys(e.contacts).length&&(o.emit("sendMessage",t,{type:"ignore"}),e.closeMe())}),r.call(),e.contacts[t]=r}function c(n,r){switch(r.type){case"answer":e.$apply(function(){e.callInProgress=!0,t(e.updateVideoPosition,1e3)});var c=Object.keys(e.contacts);0!==c.length&&o.emit("sendMessage",n,{type:"add_to_group",contacts:c,isInitiator:!1}),a(!0,n);break;case"ignore":var d=Object.keys(e.contacts).length;if(d>0){e.contacts[n]&&(e.contacts[n].close(),delete e.contacts[n]);var l=e.hideFromContactList.indexOf(n);l>-1&&e.hideFromContactList.splice(l,1),0===Object.keys(e.contacts).length&&e.closeMe()}else e.closeMe();break;case"phonertc_handshake":-1===s.indexOf(r.data)&&(e.contacts[n].receiveMessage(JSON.parse(r.data)),s.push(r.data));break;case"add_to_group":r.contacts.forEach(function(n){e.hideFromContactList.push(n),a(r.isInitiator,n),r.isInitiator||t(function(){o.emit("sendMessage",n,{type:"add_to_group",contacts:[i.currentName],isInitiator:!0})},1500)})}}console.log("parameter "+JSON.stringify(r));var s=[];e.callInProgress=!1,e.isCalling=r.isCalling,e.contactName=r.contactName,e.allContacts=i.onlineUsers,e.contacts={},e.hideFromContactList=[e.contactName],e.muted=!1,e.isCalling&&o.emit("sendMessage",r.contactName,{type:"call"}),e.ignore=function(){clearInterval(window.ringingIntervalId);var n=Object.keys(e.contacts);n.length>0?e.contacts[n[0]].disconnect():(cordova.plugins.phonertc.stopLocalStream(),o.emit("sendMessage",r.contactName,{type:"ignore"}),e.closeMe())},e.end=function(){clearInterval(window.ringingIntervalId),Object.keys(e.contacts).forEach(function(n){e.contacts[n].close(),delete e.contacts[n]}),e.closeMe()},e.answer=function(){e.callInProgress||(e.callInProgress=!0,t(e.updateVideoPosition,1e3),a(!1,r.contactName),setTimeout(function(){console.log("sending answer"),o.emit("sendMessage",r.contactName,{type:"answer"})},1500))},e.updateVideoPosition=function(){n.$broadcast("videoView.updatePosition")},e.openSelectContactModal=function(){cordova.plugins.phonertc.hideVideoView(),e.selectContactModal.show()},e.closeSelectContactModal=function(){cordova.plugins.phonertc.showVideoView(),e.selectContactModal.hide()},e.addContact=function(n){e.hideFromContactList.push(n),o.emit("sendMessage",n,{type:"call"}),cordova.plugins.phonertc.showVideoView(),e.selectContactModal.hide()},e.hideCurrentUsers=function(){return function(n){return-1===e.hideFromContactList.indexOf(n)}},e.toggleMute=function(){e.muted=!e.muted,Object.keys(e.contacts).forEach(function(n){var t=e.contacts[n];t.streams.audio=!e.muted,t.renegotiate()})},o.on("messageReceived",c),e.$on("$destroy",function(){clearInterval(window.ringingIntervalId),o.removeListener("messageReceived",c)})}]),angular.module("hariRtc.directives").directive("videoView",["$rootScope","$timeout",function(e,n){return{restrict:"E",template:'<div class="video-container"></div>',replace:!0,link:function(t,o){function i(){cordova.plugins.phonertc.setVideoView({container:o[0],local:{position:[500,500],size:[90,90]}})}n(i,500),e.$on("videoView.updatePosition",i)}}}]),angular.module("hariRtc.services").factory("ContactsService",["signaling",function(e){var n=[];return e.on("online",function(e){-1===n.indexOf(e)&&n.push(e)}),e.on("offline",function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}),{onlineUsers:n,setOnlineUsers:function(e,t){this.currentName=t,n.length=0,e.forEach(function(e){e!==t&&n.push(e)})}}}]),angular.module("hariRtc.services").factory("hariModal",["$animate","$compile","$rootScope","$controller","$q","$http","$templateCache",modalFactoryFactory]),angular.module("hariRtc.services").factory("signaling",["socketFactory","env",function(e,n){n.signalingEndpoint||(n.signalingEndpoint="https://irest.pitt.edu:8080/");var t=io.connect(n.signalingEndpoint,{secure:!0}),e=e({ioSocket:t});return e}]);